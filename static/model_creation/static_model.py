import numpy as np
from numpy import genfromtxt
from sklearn import svm
from sklearn import tree
import pickle
from sklearn.model_selection import cross_val_score
from sklearn.neural_network import MLPClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import RandomForestClassifier
from sklearn.ensemble import ExtraTreesClassifier
from sklearn.ensemble import VotingClassifier

benign = genfromtxt('benign.csv', delimiter=',',dtype='int')
malware = genfromtxt('malware.csv',delimiter=',',dtype='int')
data = np.concatenate((benign,malware),axis=0)
np.random.shuffle(data)
print(data.shape)

data1 = []
for i in range(data.shape[0]):
	curr = data[i]
	p=0
	for j in range(1,10):
		if curr[j]!=0:
			p+=1
			break
	if p:
		data1.append(curr)
print(np.array(data1).shape)
data = np.array(data1)

y_data = data[:,-1]
x_data = data[:,0:-1]


clf1 = RandomForestClassifier(n_estimators = 20)
clf2 = RandomForestClassifier(n_estimators = 20)
clf3 = RandomForestClassifier(n_estimators = 20)
clf4 = RandomForestClassifier(n_estimators = 20)
clf5 = RandomForestClassifier(n_estimators = 20)



vclf = VotingClassifier(estimators=[('first',clf1), ('second', clf2), ('third', clf3),('fourth', clf4),('fifth', clf5)],voting='hard')
print((cross_val_score(vclf,x_data,y_data,cv=10)))
vclf.fit(x_data,y_data)

pickle.dump(vclf,open('model','wb'))
