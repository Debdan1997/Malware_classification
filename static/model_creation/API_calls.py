import os
import sys
import random
import json
import numpy as np
from ast import literal_eval 
benign_path = r"Benign"

folder_list = os.listdir(benign_path)
random.shuffle(folder_list)
folder_list=folder_list[:]


strings = {}

def check_string(string):
	p = 0
	for i in string: 
		if i>='a' and i<='z':
			p=1
	if p==0:
		return 0
	p = 0
	for i in string: 
		if i>='A' and i<='A':
			p=1
	if p==0:
		return 0
	if string.endswith('.dll'):
		return 1
	for i in string:
		if not ((i>='A' and i<='Z') or (i>='a' and i<='z') or i=='\n'):
			return 0
	return 1
i = 0
for folder in folder_list:
	if i%100 ==0:
		print(i)
	i+=1
	for file in os.listdir(os.path.join(benign_path,folder)):
		#print(file)
		if file=='String.txt':
			f = open(os.path.join(benign_path,folder)+"/"+file)
			for line in f:
				#print(line, check_string(line))
				if len(line)>5 and check_string(line) and line in strings.keys():
					strings[line]+=1
				elif len(line)>5 and check_string(line) and len(strings)<=20000: strings[line]=0


#print(len(strings))
l=[]
for keys in strings.keys():
	l.append((strings[keys],keys))

j=0
l.sort()
l=l[::-1]
for i in l:
	if j==10: break
	j+=1
	print('\''+i[1].rstrip()+'\\n\',',end='')

benign_path = r"malwares"

folder_list = os.listdir(benign_path)
random.shuffle(folder_list)
folder_list=folder_list[:]


strings1 = {}

i = 0
for folder in folder_list:
	if i%100 ==0:
		print(i)
	i+=1
	for file in os.listdir(os.path.join(benign_path,folder)):
		#print(file)
		if file=='String.txt':
			f = open(os.path.join(benign_path,folder)+"/"+file)
			for line in f:
				#print(line, check_string(line))
				if len(line)>5 and check_string(line) and line in strings1.keys():
					strings1[line]+=1
				elif len(line)>5 and check_string(line) and len(strings1)<=20000: strings1[line]=0


#print(len(strings1))
l=[]
for keys in strings1.keys():
	l.append((strings1[keys],keys))

j=0
l.sort()
l=l[::-1]
for i in l:
	if j==10: break
	j+=1
	print('\''+i[1].rstrip()+'\\n\',',end='')


x = []
for key in strings.keys():
	if key not in strings1.keys():
		x.append((strings[key],key))

j=0
x.sort()
x=x[::-1]
for i in x:
	if j==10: break
	j+=1
	print('\''+i[1].rstrip()+'\\n\',',end='')

x = []
for key in strings1.keys():
	if key not in strings.keys():
		x.append((strings1[key],key))

j=0
x.sort()
x=x[::-1]
for i in x:
	if j==10: break
	j+=1
	print('\''+i[1].rstrip()+'\\n\',',end='')
