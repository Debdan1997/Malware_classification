import numpy as np
from numpy import genfromtxt
from sklearn import svm
from sklearn import tree
import pickle
from sklearn.model_selection import cross_val_score
from sklearn.neural_network import MLPClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import VotingClassifier
from sklearn.ensemble import RandomForestClassifier



benign = genfromtxt('benign.csv', delimiter=',',dtype='int')
malware = genfromtxt('malwares.csv',delimiter=',',dtype='int')
data = np.concatenate((benign,malware),axis=0)
np.random.shuffle(data)
y_data = data[:,-1]
x_data = data[:,0:-1]
print(data.shape)



dt_clf = RandomForestClassifier(n_estimators = 50,criterion = 'entropy')
sc = cross_val_score(dt_clf,x_data,y_data,cv=3)
dt_clf.fit(x_data,y_data)
pickle.dump(dt_clf,open('model','wb'))
print(np.average(sc))
